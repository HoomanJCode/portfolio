<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>HEcsGravitySim: A High-Performance Gravity Simulation in Unity - Hooman&#x27;s Portfolio</title><meta name="description" content="HEcsGravitySim is a multi-threaded gravity simulation using Unity's ECS and Job System&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://hoomanjcode.github.io/portfolio/hecsgravitysim-a-high-performance-gravity-simulation-in-unity/"><link rel="alternate" type="application/atom+xml" href="https://hoomanjcode.github.io/portfolio/feed.xml" title="Hooman&#x27;s Portfolio - RSS"><link rel="alternate" type="application/json" href="https://hoomanjcode.github.io/portfolio/feed.json" title="Hooman&#x27;s Portfolio - JSON"><meta property="og:title" content="HEcsGravitySim: A High-Performance Gravity Simulation in Unity"><meta property="og:image" content="https://hoomanjcode.github.io/portfolio/media/posts/6/Capture-1.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="675"><meta property="og:site_name" content="Hooman's Portfolio"><meta property="og:description" content="HEcsGravitySim is a multi-threaded gravity simulation using Unity's ECS and Job System&hellip;"><meta property="og:url" content="https://hoomanjcode.github.io/portfolio/hecsgravitysim-a-high-performance-gravity-simulation-in-unity/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://hoomanjcode.github.io/portfolio/assets/css/style.css?v=d43d2f7d9371f0cdd77625621254d1dd"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://hoomanjcode.github.io/portfolio/hecsgravitysim-a-high-performance-gravity-simulation-in-unity/"},"headline":"HEcsGravitySim: A High-Performance Gravity Simulation in Unity","datePublished":"2025-05-02T21:36+03:30","dateModified":"2025-05-02T21:37+03:30","image":{"@type":"ImageObject","url":"https://hoomanjcode.github.io/portfolio/media/posts/6/Capture-1.png","height":675,"width":1200},"description":"HEcsGravitySim is a multi-threaded gravity simulation using Unity's ECS and Job System&hellip;","author":{"@type":"Person","name":"Hooman Jalalpoor","url":"https://hoomanjcode.github.io/portfolio/authors/hooman-jalalpoor/"},"publisher":{"@type":"Organization","name":"Hooman Jalalpoor"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.extlink::before {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px;
				margin-right: 5px;
				position: relative;
				top: 0px;
				width: 16px;
			}
		
					.extlink.extlink-icon-11::before {
						mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'/><path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'/></svg>");
						mask-repeat: no-repeat;
						mask-size: contain;
					}</style></head><body class="post-template"><div class="container"><header class="header" id="js-header"><a href="https://hoomanjcode.github.io/portfolio/" class="logo">Hooman&#x27;s Portfolio</a></header><main class="post"><article class="content wrapper"><header class="hero"><p class="content__meta">By <a href="https://hoomanjcode.github.io/portfolio/authors/hooman-jalalpoor/" rel="author" title="Hooman Jalalpoor">Hooman Jalalpoor</a> Published on <time datetime="2025-05-02T21:36">May 2, 2025</time></p><h1 class="content__title">HEcsGravitySim: A High-Performance Gravity Simulation in Unity</h1></header><figure class="content__featured-image post__image--normal"><img src="https://hoomanjcode.github.io/portfolio/media/posts/6/Capture-1.png" srcset="https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-xs.png 300w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-sm.png 480w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-md.png 768w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-lg.png 1024w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-xl.png 1360w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-2xl.png 1600w, https://hoomanjcode.github.io/portfolio/media/posts/6/responsive/Capture-1-sm2.png 375w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="675" width="1200" alt=""><figcaption>HEcsGravitySim is a multi-threaded gravity simulation using Unity&#x27;s ECS and Job System for real-time performance. ðŸš€</figcaption></figure><div class="content__entry"><p>HEcsGravitySim is a multi-threaded gravity simulation using Unity's ECS and Job System for real-time performance. ðŸš€</p><h2 id="introduction">Introduction</h2><p>Gravity simulations are computationally expensive, especially when dealing with numerous objects. In this project,Â <strong>HEcsGravitySim</strong>, we tackle this challenge usingÂ <strong>Unity's ECS (Entity Component System)</strong>Â andÂ <strong>Job System</strong>Â to leverage multi-threading for real-time calculations. Instead of processing thousands of gravitational interactions on a single thread, which would be highly inefficient, we distribute the computations across multiple threads for a significant performance boost.</p><h2 id="the-problem-gravity-calculation-bottleneck">The Problem: Gravity Calculation Bottleneck</h2><p>In a naive implementation of a gravity simulation, each planet applies a force to every other planet. This results in aÂ <strong>nested loop</strong>Â withÂ <strong>O(nÂ²) complexity</strong>, where each frame requires computing forces for every pair of planets. WithÂ <strong>1000 planets</strong>, this means 1,000,000 force calculations per frame! Running this on a single thread would lead to severe performance issues.</p><h2 id="the-solution-multi-threading-and-data-oriented-programming">The Solution: Multi-Threading and Data-Oriented Programming</h2><p>To overcome this computational bottleneck, we use Unity'sÂ <strong>Data-Oriented Technology Stack (DOTS)</strong>, which includes:</p><ul><li><strong>Job System</strong>Â â€“ Enables multithreaded computations efficiently.</li><li><strong>ECS (Entity Component System)</strong>Â â€“ Provides a high-performance, data-oriented programming model.</li><li><strong>Hybrid Renderer Package</strong>Â â€“ Ensures optimized rendering.</li><li><strong>Unity Physics (Havok Physics)</strong>Â â€“ Handles physics interactions accurately.</li></ul><p>By structuring the simulation usingÂ <strong>ECS and Jobs</strong>, we efficiently distribute calculations across multiple CPU cores, leading to a significant boost in performance and real-time simulation capabilities.</p><h2 id="gravity-calculation-formula">Gravity Calculation Formula</h2><p>The gravitational force between two planets is calculated using Newton's Law of Universal Gravitation:</p><p>F=Gm1m2r2F = G \frac{m_1 m_2}{r^2}</p><p>Where:</p><ul><li>FF is the gravitational force,</li><li>GG is the gravitational constant,</li><li>m1,m2m_1, m_2 are the masses of the two planets,</li><li>rr is the distance between the two planets.</li></ul><h3 id="unity-implementation-example">Unity Implementation Example:</h3><pre class="language-glsl"><code>float3 direction = planet2.Position - planet1.Position;
float distanceSquared = math.lengthsq(direction) + 0.0001f; // Avoid division by zero
float forceMagnitude = (G * planet1.Mass * planet2.Mass) / distanceSquared;
float3 force = math.normalize(direction) * forceMagnitude;</code></pre><h2 id="project-breakdown">Project Breakdown</h2><h3 id="1-random-planet-generator">1.Â <strong>Random Planet Generator</strong></h3><ul><li>A class that generatesÂ <strong>randomly placed planets</strong>Â within the simulation space.</li><li>Assigns each planet aÂ <strong>random velocity and mass</strong>.</li></ul><h3 id="2-planet-component-data">2.Â <strong>Planet Component Data</strong></h3><ul><li>Stores essential planet properties such as:<ul><li>Position</li><li>Velocity</li><li>Mass</li></ul></li></ul><h3 id="3-gravity-system">3.Â <strong>Gravity System</strong></h3><ul><li>UsesÂ <strong>Entity Query</strong>Â to fetch all planets.</li><li>Executes aÂ <strong>multithreaded job</strong>Â each frame to calculate gravitational forces efficiently.</li><li>Applies forces to theÂ <strong>Velocity Component</strong>, allowing the physics engine to update positions automatically.</li></ul><h3 id="4-job-system-for-parallel-processing">4.Â <strong>Job System for Parallel Processing</strong></h3><ul><li>Each frame, the system:<ol><li>Loops over all planet entities usingÂ <strong>nested loops</strong>.</li><li>Distributes the calculations across multiple CPU cores usingÂ <strong>Jobs</strong>.</li><li>Applies the calculated forces toÂ <strong>update velocity</strong>Â components.</li><li>The physics engine then computes the new positions.</li></ol></li></ul><h2 id="performance-gains">Performance Gains</h2><p>By implementingÂ <strong>ECS and Job System</strong>, we achieve:</p><ul><li><strong>Massively improved performance</strong>Â due to parallel processing.</li><li><strong>Real-time gravity simulation</strong>Â with thousands of planets.</li><li><strong>Efficient memory management</strong>, reducing CPU bottlenecks.</li><li><strong>Smooth rendering</strong>Â using the Hybrid Renderer package.</li></ul><h2 id="conclusion">Conclusion</h2><p>HEcsGravitySim showcases the power ofÂ <strong>Data-Oriented Programming</strong>Â in Unity, enabling efficient and scalable physics simulations. WithÂ <strong>ECS, Job System, and Unity Physics</strong>, we can simulate complex gravitational interactions at real-time speeds, even with thousands of entities.</p><p>If you're interested in high-performance game development or physics simulations, exploring Unity'sÂ <strong>DOTS ecosystem</strong>Â is a great step forward!</p><p>Stay tuned for further improvements and optimizations! ðŸš€</p><h3 id="github-repository">GitHub Repository</h3><p>Check out the source code on GitHub: <a href="https://github.com/HoomanJCode/HEcsGravitySim" target="_blank" class="extlink extlink-icon-11" rel="noopener noreferrer">HEcsGravitySim</a></p><p>Â </p></div><footer class="content__footer"><div class="content__last-updated">This article was updated on May 2, 2025</div><div class="content__footer__col"><ul class="content__tag"><li><a href="https://hoomanjcode.github.io/portfolio/tags/art/">Art</a></li><li><a href="https://hoomanjcode.github.io/portfolio/tags/generativeart/">GenerativeArt</a></li><li><a href="https://hoomanjcode.github.io/portfolio/tags/open-source/">Open-Source</a></li><li><a href="https://hoomanjcode.github.io/portfolio/tags/performance/">Performance</a></li><li><a href="https://hoomanjcode.github.io/portfolio/tags/unity/">Unity</a></li></ul><div class="content__share"></div></div><nav class="content__nav"><div class="content__nav__prev">Previous Post<h5><a href="https://hoomanjcode.github.io/portfolio/rainy-cloud-a-melancholic-yet-hopeful-puzzle-adventure/" class="invert" rel="prev">Rainy Cloud: A Melancholic Yet Hopeful Puzzle Adventure</a></h5></div><div class="content__nav__next">Next Post<h5><a href="https://hoomanjcode.github.io/portfolio/menuview-package-in-unity-simple-menu-management-tool/" class="invert" rel="next">MenuView-Package in Unity: Simple Menu Management Tool</a></h5></div></nav><div class="content__bio"><div><h3><a href="https://hoomanjcode.github.io/portfolio/authors/hooman-jalalpoor/" class="invert" title="Hooman Jalalpoor">Hooman Jalalpoor</a></h3></div></div><div class="content__related"><h3 class="u-h5">Related posts</h3><div class="content__related__wrap"><figure><figcaption><h4><a href="https://hoomanjcode.github.io/portfolio/boost-your-unity-development-with-concurrenttools-package/" class="invert">Boost Your Unity Development with ConcurrentTools-Package</a></h4><time datetime="2025-05-02T21:50">May 2, 2025</time></figcaption></figure><figure><figcaption><h4><a href="https://hoomanjcode.github.io/portfolio/menuview-package-in-unity-simple-menu-management-tool/" class="invert">MenuView-Package in Unity: Simple Menu Management Tool</a></h4><time datetime="2025-05-02T21:41">May 2, 2025</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div></footer></div><script defer="defer" src="https://hoomanjcode.github.io/portfolio/assets/js/scripts.min.js?v=4268bfae06e330d473c424d50f09abda"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.navbar'};</script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>
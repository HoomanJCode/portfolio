<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Balls of Chaos: A Game Jam Triumph in 100 Seconds of Mayhem - Hooman&#x27;s Portfolio</title><meta name="description" content="Survive 100 seconds of chaos in Balls of Chaos, a fast-paced bullet-hell&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#FFCE00" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#FFCE00"><meta name="apple-mobile-web-app-status-bar-style" content="#FFCE00"><link rel="canonical" href="https://hooman.jalalpoor.com/balls-of-chaos-a-game-jam-triumph-in-100-seconds-of-mayhem/"><link rel="alternate" type="application/atom+xml" href="https://hooman.jalalpoor.com/feed.xml" title="Hooman&#x27;s Portfolio - RSS"><link rel="alternate" type="application/json" href="https://hooman.jalalpoor.com/feed.json" title="Hooman&#x27;s Portfolio - JSON"><meta property="og:title" content="Balls of Chaos: A Game Jam Triumph in 100 Seconds of Mayhem"><meta property="og:image" content="https://hooman.jalalpoor.com/media/posts/4/1GE-kJ.png"><meta property="og:image:width" content="1600"><meta property="og:image:height" content="900"><meta property="og:site_name" content="Hooman's Portfolio"><meta property="og:description" content="Survive 100 seconds of chaos in Balls of Chaos, a fast-paced bullet-hell&hellip;"><meta property="og:url" content="https://hooman.jalalpoor.com/balls-of-chaos-a-game-jam-triumph-in-100-seconds-of-mayhem/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://hooman.jalalpoor.com/media/website/minimal-art-style-website-favicon-for-a-game-developer-Copy.png" type="image/png"><link rel="stylesheet" href="https://hooman.jalalpoor.com/assets/css/style.css?v=703cd6501087ec69fd6a14b3f9297d41"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://hooman.jalalpoor.com/balls-of-chaos-a-game-jam-triumph-in-100-seconds-of-mayhem/"},"headline":"Balls of Chaos: A Game Jam Triumph in 100 Seconds of Mayhem","datePublished":"2025-05-02T20:40+03:30","dateModified":"2025-05-02T20:44+03:30","image":{"@type":"ImageObject","url":"https://hooman.jalalpoor.com/media/posts/4/1GE-kJ.png","height":900,"width":1600},"description":"Survive 100 seconds of chaos in Balls of Chaos, a fast-paced bullet-hell&hellip;","author":{"@type":"Person","name":"Hooman Jalalpoor","url":"https://hooman.jalalpoor.com/authors/hooman-jalalpoor/"},"publisher":{"@type":"Organization","name":"Hooman Jalalpoor"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.extlink::before {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px;
				margin-right: 5px;
				position: relative;
				top: 0px;
				width: 16px;
			}
		
					.extlink.extlink-icon-11::before {
						mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'/><path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'/></svg>");
						mask-repeat: no-repeat;
						mask-size: contain;
					}</style></head><body class="post-template"><div class="container"><header class="header" id="js-header"><a href="https://hooman.jalalpoor.com/" class="logo">Hooman&#x27;s Portfolio</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Links</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://hoomanj.itch.io/" target="_blank">Itch</a></li><li><a href="https://github.com/HoomanJCode" target="_blank">Github</a></li><li><a href="https://www.linkedin.com/in/hooman-jalalpoor/" target="_self">Linkedin</a></li><li><a href="https://www.fxhash.xyz/u/Parallax%20Rendering" target="_blank">Fxhash (Artworks)</a></li></ul></li><li><a href="https://hooman.jalalpoor.com/contact-me/" target="_self">Contact Me</a></li></ul></nav></header><main class="post"><article class="content wrapper"><header class="hero"><p class="content__meta">By <a href="https://hooman.jalalpoor.com/authors/hooman-jalalpoor/" rel="author" title="Hooman Jalalpoor">Hooman Jalalpoor</a> Published on <time datetime="2025-05-02T20:40">May 2, 2025</time></p><h1 class="content__title">Balls of Chaos: A Game Jam Triumph in 100 Seconds of Mayhem</h1></header><figure class="content__featured-image post__image--normal"><img src="https://hooman.jalalpoor.com/media/posts/4/1GE-kJ.png" srcset="https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-xs.png 300w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-sm.png 480w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-md.png 768w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-lg.png 1024w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-xl.png 1360w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-2xl.png 1600w, https://hooman.jalalpoor.com/media/posts/4/responsive/1GE-kJ-sm2.png 375w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="900" width="1600" alt=""><figcaption>Survive 100 seconds of chaos in Balls of Chaos, a fast-paced bullet-hell arcade game. Strategize, dodge, and outlast an endless swarm of balls!</figcaption></figure><div class="content__entry"><p>Survive 100 seconds of chaos in Balls of Chaos, a fast-paced bullet-hell arcade game. Strategize, dodge, and outlast an endless swarm of balls!</p><h2 id="a-high-speed-descent-into-chaos">A High-Speed Descent into Chaos</h2><p>Imagine stepping into an arena where the only rule is survival. The clock is ticking, the walls are closing in, and an ever-growing swarm of balls threatens to consume everything in sight. Welcome toÂ <em>Balls of Chaos</em>, a relentless bullet-hell arcade experience that blends strategy, reflexes, and sheer nerve into 100 seconds of escalating madness.</p><p>Developed in justÂ <strong>seven days</strong>Â for the Brackeys 2021.2 Game Jam,Â <em>Balls of Chaos</em>Â was born from the themeÂ <em>â€œLet There Be Chaos.â€</em>Â The result? A fast-paced, pixel-perfect indie game that ranked among theÂ <strong>Top 50 entries</strong>Â and left players both exhilarated and exhausted.</p><figure class="kg-card kg-image-card"><figure class="kg-image"><img src="https://hooman.jalalpoor.com/content/images/2025/03/3pZmfu-1.gif" srcset="https://hooman.jalalpoor.com/content/images/2025/03/3pZmfu-1.gif 600w" alt="" width="600" height="338" loading="lazy" data-is-external-image="true"></figure></figure><h2 id="the-gameplay-simple-premise-insane-execution">The Gameplay: Simple Premise, Insane Execution</h2><p>At its core,Â <em>Balls of Chaos</em>Â is a game aboutÂ <strong>endurance</strong>. The concept is straightforward:</p><ol><li><strong>Survive 100 seconds</strong>Â without being overwhelmed.</li><li><strong>Defend against multiplying balls</strong>Â that split and evolve with every impact.</li><li><strong>Rack up points</strong>Â by bouncing balls off your paddleâ€”but beware, every hit spawns new threats.</li></ol><p>The gameâ€™sÂ <em>ball-splitting system</em>Â is what takes it from a simple arcade game to a finely tuned chaos simulator:</p><ul><li>AÂ <strong>Mother Ball</strong>Â spawns and moves toward your paddle.</li><li>When it collides, itÂ <strong>splits into two balls</strong>, increasing the total count.</li><li>Balls gainÂ <strong>value and speed</strong>Â with each impact, creating an ever-growing swarm of threats.</li><li>You earnÂ <strong>points equal to a ballâ€™s value</strong>Â when successfully bouncing it.</li><li><strong>Letting a ball slip past</strong>Â results in even more chaosâ€”so keep your defenses tight!</li></ul><p>The first 30 seconds might seem manageable, but as time progresses, the arena transforms into a neon-litÂ <strong>hurricane of bouncing orbs</strong>. Strategy becomes key: Do you risk increasing the ball count for a higher score, or do you play conservatively to extend your survival?</p><hr><h2 id="the-madness-of-the-final-10-seconds">The Madness of the Final 10 Seconds</h2><p>By the time you reach the 90-second mark,Â <em>Balls of Chaos</em>Â has fully embraced its name. The screen explodes into a high-speed flurry of movement, and only the most skilled players will hold their ground. If youâ€™ve made it this far, congratulationsâ€”youâ€™re officially a chaos master.</p><p>But for those who crave an even greater challenge,Â <strong>a secret mode awaits</strong>. Only the bravest will uncover its secrets and push the limits of their reflexes.</p><hr><figure class="kg-card kg-image-card"><figure class="kg-image"><img src="https://hooman.jalalpoor.com/content/images/2025/03/x_UqF6.gif" alt="" width="315" height="250" loading="lazy" data-is-external-image="true"></figure></figure><h2 id="aesthetic-art-style-controlled-chaos-in-pixel-form">Aesthetic &amp; Art Style: Controlled Chaos in Pixel Form</h2><p>Visually,Â <em>Balls of Chaos</em>Â embraces aÂ <strong>retro-futuristic pixel art</strong>Â style that pays homage to classic arcade games while adding a modern twist. The vibrantÂ <strong>color palette was carefully chosen</strong>Â to balance chaos and clarity, ensuring that the action remains visually engaging yet not overwhelming.</p><p>TheÂ <strong>primary background colors</strong>Â were selected to create a stark contrast with the bouncing balls, allowing players to track movement effortlessly. The glowingÂ <strong>neon reds, greens, and blues</strong>Â enhance the feeling of urgency, making every moment feel like an electrifying battle for survival. The pixelated aesthetic, masterfully crafted byÂ <strong>Htet Oo Lwin</strong>, not only adds nostalgic appeal but also complements the gameâ€™s fast-paced mechanics.</p><p>By mixing old-school pixel graphics with high-speed animation effects,Â <em>Balls of Chaos</em>Â successfully captures the thrill of classic bullet-hell games while carving out a distinct identity of its own.</p><hr><h2 id="why-you%E2%80%99ll-love-or-rage-quit-balls-of-chaos">Why Youâ€™ll Love (or Rage Quit)Â <em>Balls of Chaos</em></h2><ul><li><strong>Bullet-Hell with Brains</strong>Â â€“ Unlike mindless arcade shooters,Â <em>Balls of Chaos</em>Â demands bothÂ <strong>quick reflexes</strong>Â andÂ <strong>strategic thinking</strong>.</li><li><strong>Secret Mode &amp; Online Leaderboards</strong>Â â€“ Compete against global players and unlock hidden chaos if you dare.</li><li><strong>Pixel-Perfect Aesthetic</strong>Â â€“ The vibrant pixel art byÂ <strong>Htet Oo Lwin</strong>Â and an adrenaline-pumpingÂ <strong>synthwave soundtrack by Hesam</strong>Â create an immersive, retro-futuristic vibe.</li><li><strong>A Game Jam Masterpiece</strong>Â â€“ Developed in justÂ <strong>seven days</strong>Â by a four-person indie team, this game is a testament to raw creativity and skill under pressure.</li></ul><hr><h2 id="the-dev-team-behind-the-chaos">The Dev Team Behind the Chaos</h2><p><em>Balls of Chaos</em>Â was crafted by an all-star indie team:</p><ul><li><strong>Madzaa</strong>Â â€“ Game Design</li><li><a href="https://hooman.jalalpoor.com/" rel="noreferrer"><strong>Hooman Jalalpoor</strong></a>Â â€“ Programming</li><li><a href="https://htetoolwin676.carrd.co" class="extlink extlink-icon-11"><strong>Htet Oo Lwin</strong>Â </a>â€“ Art</li><li><a href="https://hesam.jalalpoor.com/" class="extlink extlink-icon-11"><strong>Hesam Jalalpoor</strong>Â </a>â€“ Music &amp; SFX</li></ul><h2 id="play-now-%E2%80%93-if-you-can-handle-it">Play Now â€“ If You Can Handle It</h2><p>Think you have what it takes to surviveÂ <em>Balls of Chaos</em>?</p><p>ğŸ•¹ï¸Â <strong>Download Now</strong>Â on itch.io: <a href="https://madzaa.itch.io/balls-of-chaos" class="extlink extlink-icon-11">madzaa.itch.io/balls-of-chaos</a></p><p>ğŸ® Available forÂ <strong>Windows, Linux, and Android</strong>.</p><h2 id="final-thoughts-from-the-developers">Final Thoughts from the Developers</h2><blockquote><em>â€œWe set out to create something that feels fast, fun, and punishing all at onceâ€”a game where every second is a battle. We think we nailed it. And that secret mode? Well, letâ€™s just say itâ€™s where the real chaos begins.â€</em>Â â€“ Hooman Jalalpoor, Programmer</blockquote><p>So, the question is:Â <strong>Can you outlast the chaos?</strong>Â Step up, take the challenge, and see if you can secure a place on the leaderboard. ğŸ”¥</p><hr><p><strong>#BallsOfChaos #IndieGame #BulletHell #GameJam</strong></p><p>â­â­â­â­â­Â <em>â€œAn adrenaline-fueled ride from start to finish.â€</em></p></div><footer class="content__footer"><div class="content__last-updated">This article was updated on May 2, 2025</div><div class="content__footer__col"><ul class="content__tag"><li><a href="https://hooman.jalalpoor.com/tags/game/">Game</a></li></ul><div class="content__share"></div></div><nav class="content__nav"><div class="content__nav__prev">Previous Post<h5><a href="https://hooman.jalalpoor.com/impasse-a-puzzle-action-gem-born-from-collaboration-and-hope/" class="invert" rel="prev">Impasse: A Puzzle-Action Gem Born from Collaboration and Hope</a></h5></div><div class="content__nav__next">Next Post<h5><a href="https://hooman.jalalpoor.com/rainy-cloud-a-melancholic-yet-hopeful-puzzle-adventure/" class="invert" rel="next">Rainy Cloud: A Melancholic Yet Hopeful Puzzle Adventure</a></h5></div></nav><div class="content__bio"><img src="https://hooman.jalalpoor.com/media/website/dfjhkk-2-2xl.png" loading="eager" height="600" width="600" alt="Hooman Jalalpoor"><div><h3><a href="https://hooman.jalalpoor.com/authors/hooman-jalalpoor/" class="invert" title="Hooman Jalalpoor">Hooman Jalalpoor</a></h3><p>Hi, Iâ€™m Hooman Jalalpoorâ€”an Indie Game Programmer, Software Engineer, and Generative Artist. With a deep passion for creating immersive and artistic games, I specialize in game development using Unity and C#, as well as crafting unique generative art and NFTs.<br><br>My journey in game development has been driven by a love for storytelling, creativity, and innovation. Iâ€™ve participated in numerous game jams, where my team and I created award-winning games like Impasse, Balls of Chaos, and Shattered. These experiences have honed my skills in game design, team collaboration, and rapid prototyping.<br><br>Beyond games, Iâ€™ve explored the intersection of art and technology by producing generative artworks and NFTs, leveraging tools like JavaScript and p5.js. My work in this space has not only allowed me to express my creativity but also to understand the dynamics of the digital art market.<br><br>I hold a Masterâ€™s degree in Computer Software Engineering, where I focused on neural networks and blockchain technology for cryptocurrency price prediction. This academic background has equipped me with a strong foundation in machine learning, optimization, and research, which I often integrate into my projects.<br><br>Currently, I serve as the Manager of the Academy of Technical Experiences, where I oversee program development and foster a learning environment for aspiring technical professionals. This role has allowed me to grow as a leader while sharing my knowledge with others.<br><br>Iâ€™m also passionate about education and have created game-making tutorials in Persian to help aspiring developers in my community. Although this venture was cut short, I hope to continue creating educational content in the future.<br><br>When Iâ€™m not coding or designing games, youâ€™ll find me exploring new technologies, experimenting with procedural art, or brainstorming ideas for my next project. My ultimate goal is to create games and experiences that resonate with players on an emotional and artistic level.<br><br>Letâ€™s connect and create something amazing together!</p></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">@HoomanJalalpoor</div></footer></div><script defer="defer" src="https://hooman.jalalpoor.com/assets/js/scripts.min.js?v=4268bfae06e330d473c424d50f09abda"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.navbar'};</script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        initialLsState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('ğŸª Config not found, or configuration expired');
            }

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                    'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                    'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                    'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                    'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                    'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                    'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                });  
                
                if (cbConfig.debugMode) {
                    console.log('ğŸª GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                        'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                        'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                        'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                        'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                        'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                        'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                    }));
                }
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('ğŸª Config founded');
            }

            cbConfig.initialLsState = currentConfig.split(',');

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                    'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                    'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                    'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                    'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                    'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                    'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                });
                
                if (cbConfig.debugMode) {
                    console.log('ğŸª GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                        'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                        'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                        'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                        'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                        'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                        'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                    }));
                }
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function getDefaultConsentState (currentConfig, consentGroup) {
        let configGroups = currentConfig.split(',');

        for (let i = 0; i < configGroups.length; i++) {
            let groupName = configGroups[i];
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === groupName);

            if (group && group[consentGroup]) {
                return 'granted';
            }
        }  
        
        if (window.publiiCBGCM.defaultState[consentGroup]) {
            return 'granted'; 
        }
        
        return 'denied';
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('ğŸª Allowed group: ' + allowedGroup);
        }

        if (window.publiiCBGCM && (!cbConfig.initialLsState || cbConfig.initialLsState.indexOf(allowedGroup) === -1)) {
            let consentResult = {};
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === allowedGroup);

            if (group) {
                let foundSomeConsents = false;

                Object.keys(group).forEach(key => {
                    if (key !== 'cookieGroup' && group[key] === true) {
                        consentResult[key] = 'granted';
                        foundSomeConsents = true;
                    }
                });

                if (foundSomeConsents) {
                    gtag('consent', 'update', consentResult);   

                    if (cbConfig.debugMode) {
                        console.log('ğŸª GCMv2 UPDATE: ' + JSON.stringify(consentResult));
                    }
                }
            }
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('ğŸª Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('ğŸª Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('ğŸª State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('ğŸª Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('ğŸª Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('ğŸª Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('ğŸª Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('ğŸª Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupToCheck !== '' && groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('ğŸª Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('ğŸª Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>